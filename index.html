<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tautika</title>
<style>
	body {
		margin: 0;
		font-family: sans-serif;
		display: flex;
		flex-direction: column;
		height: 100vh;
		background: #111;
		color: #eee;
	}
	#top-bar {
		display: flex;
		flex-direction: column;
		padding: 8px;
		padding-top: 30px;
		background: #222;
		/* flex: 0 0 20%; */
	}
	input {
		margin: 4px 0;
		padding: 10px;
		border: none;
		border-radius: 6px;
		font-size: 1em;
		background: #333;
		color: #fff;
	}
	button {
		padding: 10px;
		border: none;
		border-radius: 6px;
		font-size: 1em;
		background: #2956b8;
		color: #f5f5f5;
		cursor: pointer;
		margin-top: 8px;
	}
	button:hover {
		background: #3062cd;
	}
	button:active {
		background: #467ee7;
	}
	#results {
		flex: 1;
		overflow-y: auto;
		padding: 4px 10px;
		margin-bottom: 20px;
	}
	.app-zone {
		margin: 5px;
		background: #1b1b1b;
		border-radius: 8px;
		padding: 15px;
	}
	.walk {
		height: 15px;
		border-left: 2px dashed #555;
		margin: 5px 30px;
	}
	.app-name {
		font-size: 1.2em;
		font-weight: bold;
		color: rgb(117, 164, 226);
	}
	.zone-name {
		font-size: 0.9em;
		color: #aaa;
		margin-bottom: 15px;
		margin-top: 4px;
	}
	.route {
		margin-top: 6px;
	}
</style>
</head>
<body>
	<div id="top-bar">
		<input id="origin" placeholder="Origin">
		<input id="destination" placeholder="Destination">
		<button onclick="searchRoutes()">Search</button>
	</div>
	<div id="results"></div>

	<script src="zonebridge.js?v=<?php echo time(); ?>"></script>
	<script>
		async function searchRoutes() {
			const container = document.getElementById('results');
			container.innerHTML = "<p>Searching...</p>";
			const origin = document.getElementById('origin').value.trim();
			const destination = document.getElementById('destination').value.trim();
			result = await findPath(origin, destination);
			console.log("Search result:", result);
			await displayResults(result);
		}

		async function displayResults(data) {
			const container = document.getElementById('results');
			container.innerHTML = "";
			console.log("Displaying results:", data);
			if (!data || data.length === 0) {
				container.innerHTML = "<p>No routes found.</p>";
				return;
			}
			container.innerHTML = await data.slice(0, -1).map(item => `
				<div class="walk"></div>
					<p style='margin: 0 15px; color: #dddddd; font-size: 15px'>Walk ${item.walk}m</p>
				<div class="walk"></div>
				<div class="app-zone">
					<div class="app-name">${item.application}</div>
					<div class="zone-name">${item.zone}</div>
					<table>
						<tr>
							<td style='color: #aaa' align='right'>From:</td>
							<td style='margin-left: 8px'>${item.station1}</td>
						</tr>
						<tr>
							<td style='color: #aaa' align='right'>To:</td>
							<td style='margin-left: 8px'>${item.station2}</td>
						</tr>
					</table>
				</div>
			`).join("");
			container.innerHTML += `
				<div class="walk"></div>
					<p style='margin: 0 15px; color: #dddddd; font-size: 15px'>
						Walk ${data[data.length-1].walk}m to destination
					</p>`;
		}
	</script>
</body>
</html>